{% extends 'token_administration/base.html' %}
{% load static %}

{% block content %}
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold">Tokens</h1>
        {% if can_add_token %}
            <a href="{% url 'token_create' %}" class="btn btn-primary btn-sm">Create New Token</a>
        {% endif %}
    </div>

    <div class="mb-8">
        <h2 class="text-xl font-semibold mb-2">Your Tokens ({{ tokens.count }}/{{ max_tokens }})</h2>
        {% if tokens %}
            <ul class="list bg-base-100 rounded-box shadow-md">
                {% for token in tokens %}
                    <li class="list-row flex justify-between items-center">
                        <div class="flex items-center flex-grow mr-4 overflow-hidden">
                            <img src="{% static 'icons/key.svg' %}" alt="Token" class="w-5 mr-2 flex-shrink-0 [[data-theme=dark]_&]:invert">
                            <span class="font-medium truncate mr-2">{{ token.name }}</span>
                            <span class="text-sm opacity-50 flex-shrink-0">
                                Created: {{ token.created_at|date:"Y-m-d" }}
                            </span>
                            <span class="text-sm opacity-50 flex-shrink-0 ml-2">
                                Token: {{ token.key }}
                            </span>
                        </div>
                        <a href="{% url 'token_delete' token.id %}" class="btn btn-error btn-sm btn-square mr-2" title="Delete {{ token.name }}">
                            <img src="{% static 'icons/delete.svg' %}" alt="Delete" class="w-4 h-4 [[data-theme=dark]_&]:invert">
                        </a>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="text-gray-500 italic">No tokens available.</p>
        {% endif %}
    </div>

    <div class="mb-8">
        <h2 class="text-xl font-semibold mb-2">Service Accounts</h2>
        {% if service_accounts %}
            <ul class="list bg-base-100 rounded-box shadow-md">
                {% for sa in service_accounts %}
                    <li class="list-row flex justify-between items-center">
                        <div class="flex items-center flex-grow mr-4 overflow-hidden">
                            <img src="{% static 'icons/key.svg' %}" alt="Service Account" class="w-5 mr-2 flex-shrink-0 [[data-theme=dark]_&]:invert">
                            <span class="font-medium truncate mr-2">{{ sa.name }}</span>
                            <span class="text-sm opacity-50 flex-shrink-0">
                                Team: {{ sa.team.name }}
                            </span>
                            <span class="text-sm opacity-50 flex-shrink-0 ml-2">
                                Token: {{ sa.token.key }}
                            </span>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="text-gray-500 italic">No service accounts available.</p>
        {% endif %}
    </div>
{% endblock %}
